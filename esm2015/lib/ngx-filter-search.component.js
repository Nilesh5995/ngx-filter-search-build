import { Component, Input, EventEmitter, Output } from '@angular/core';
import * as _ from 'lodash';
export class NgxFilterSearchComponent {
    constructor() {
        this.filteredData = new EventEmitter();
        this.tempFilter = {};
        this.allSelectedFilters = [];
        this.filter = 'all';
        this.sort = 'lot_number_low';
        this.isSorted = false;
        this.defaultFilter = 'all';
        this.defaultSort = 'lot_number_low';
        this.defaultSearch = '';
        this.value = 30;
        this.tooltip = { placement: 'Before', isVisible: true, showOn: 'Always' };
        this.ticks = { placement: 'After', largeStep: 20, smallStep: 10, showSmallTicks: true };
        this.step = 50;
    }
    ngOnInit() {
        if (this.data && this.config) {
            this.setFilterConfig(this.data);
            this.filterData = this.data;
        }
        else {
            console.log('please Add the data and config');
        }
    }
    setFilterConfig(data) {
        for (let i = data.length - 1; i >= 0; i--) {
            let statusName;
            data[i]['statusName'] = statusName;
            // Create the key for the custom fields.... Add the custom_ before each custom filed name...
            if (data[i].customFields && !_.isEmpty(data[i].customFields)) {
                const customFields = data[i].customFields;
                for (const item in customFields) {
                    if (customFields[item].showFilter) {
                        // Create the unique key for the custom fields.
                        let key = 'custom_' + item;
                        // Change the config for the the display name want to show different.
                        const c = _.get(this.config.fieldsConfigCustomChanges, key);
                        if (c) {
                            // Code for adding the empty data as the not dated lots....
                            const value = customFields[item].value == c.value ? c.replaceValue : customFields[item].value;
                            const name = customFields[item].value == c.value ? c.displayName : customFields[item].value;
                            data[i]['custom_' + customFields[item].name] = value;
                            data[i]['custom_display_' + customFields[item].name] = name;
                        }
                        else {
                            data[i]['custom_' + customFields[item].name] = customFields[item].value;
                        }
                    }
                }
            }
            this.setCheckBoxFilter(data[i]);
        }
        this.sortCheckBoxesFilter();
    }
    setCheckBoxFilter(data) {
        // Checked the filter parameter
        if (this.config.filter && this.config.filter.filterParameter) {
            for (let j = this.config.filter.filterParameter.length - 1; j >= 0; j--) {
                var configIndex = this.config.filter.filterParameter[j];
                if (configIndex.isShowFilter) {
                    var key = configIndex.filterBy;
                    var isRangeFilterWithDiffValue = false;
                    if (data.hasOwnProperty(configIndex.lowValueFieldValue) && data.hasOwnProperty(configIndex.highValueFieldValue)) {
                        isRangeFilterWithDiffValue = true;
                    }
                    else {
                        isRangeFilterWithDiffValue = false;
                    }
                    if (data.hasOwnProperty(key) || isRangeFilterWithDiffValue) {
                        if (this.tempFilter.hasOwnProperty(key)) {
                            if ((data[configIndex.fieldName] && data[configIndex.fieldValue]) || (isRangeFilterWithDiffValue)) {
                                let obj = {};
                                if (configIndex.filterType == 'checkBoxes') {
                                    obj['filterBy'] = key;
                                    obj['fieldName'] = data[configIndex.fieldName];
                                    obj['fieldValue'] = configIndex.dataType == Number ? Number(data[configIndex.fieldValue]) : data[configIndex.fieldValue];
                                    obj['isChecked'] = false;
                                    //console.log( obj['fieldValue'], 'OBJ FIELDS VALUE')
                                    var self = this;
                                    var isPresent = this.tempFilter[key].some(function (el) { return el['fieldValue'] == data[self.config.filter.filterParameter[j].fieldValue]; });
                                    if (!isPresent) {
                                        self.tempFilter[self.config.filter.filterParameter[j].filterBy].push(obj);
                                    }
                                }
                                else if (configIndex.filterType == 'range_slider') {
                                    let previousMin = this.tempFilter[key].minValue;
                                    let previousMax = this.tempFilter[key].maxValue;
                                    let currentMinValue = Number(data[configIndex.lowValueFieldValue]);
                                    let currentMaxValue = Number(data[configIndex.highValueFieldValue]);
                                    let min = previousMin < currentMinValue ? previousMin : currentMinValue;
                                    let max = previousMax > currentMaxValue ? previousMax : currentMaxValue;
                                    this.tempFilter[key]['minValue'] = min;
                                    this.tempFilter[key]['maxValue'] = max;
                                    this.tempFilter[key]['rangeValue'] = [];
                                    this.tempFilter[key]['defaultRangeValue'] = [];
                                    this.tempFilter[key]['dropDownRangeValues'] = [];
                                    this.tempFilter[key]['rangeValue'].push(min);
                                    this.tempFilter[key]['rangeValue'].push(max);
                                    let smallStep = configIndex.step ? (configIndex.step * 2) : 100;
                                    let largeStep = configIndex.step || 50;
                                    let diff = max - min;
                                    this.tempFilter[key]['smallStep'] = diff / smallStep;
                                    this.tempFilter[key]['largeStep'] = diff / largeStep;
                                    this.tempFilter[key]['ticks'] = { placement: 'After', largeStep: diff / largeStep, smallStep: diff / smallStep, showSmallTicks: true, showLargeTicks: false };
                                    this.tempFilter[key]['defaultRangeValue'].push(min);
                                    this.tempFilter[key]['defaultRangeValue'].push(max);
                                    this.tempFilter[key]['dropDownRangeValues'].push(min);
                                    this.tempFilter[key]['dropDownRangeValues'].push(max);
                                    this.tempFilter[key]['rangeStep'] = smallStep; //diff / smallStep;
                                    //   filterArrayRangeFilter
                                    // showOn: 'Always'
                                    this.tempFilter[key]['dropdown'] = [];
                                    let dropdownValue = min;
                                    for (let k = 0; k <= smallStep; k++) {
                                        this.tempFilter[key]['dropdown'].push(dropdownValue);
                                        dropdownValue = (diff / smallStep) + dropdownValue;
                                    }
                                    this.tempFilter[key]['dropdown'] = _.uniq(this.tempFilter[key]['dropdown']);
                                }
                            }
                        }
                        else {
                            let obj = {};
                            if (configIndex.isShowFilter) {
                                if ((data[configIndex.fieldName] && data[configIndex.fieldValue]) || (isRangeFilterWithDiffValue)) {
                                    this.tempFilter[key] = [];
                                    this.tempFilter[key]['filterTitle'] = configIndex.filterTitle;
                                    this.tempFilter[key]['isShowFilter'] = configIndex.isShowFilter;
                                    this.tempFilter[key]['filterBy'] = key;
                                    this.tempFilter[key]['filterValuesSorting'] = configIndex.filterValuesSorting;
                                    this.tempFilter[key]['filterSortDirection'] = configIndex.filterSortDirection;
                                    this.tempFilter[key]['isShowMore'] = false;
                                    this.tempFilter[key]['filterCheckBoxLimit'] = configIndex.filterCheckBoxLimit;
                                    this.tempFilter[key]['filterType'] = configIndex.filterType;
                                    if (configIndex.filterType == 'checkBoxes') {
                                        obj['filterBy'] = key;
                                        obj['fieldName'] = data[configIndex.fieldName];
                                        obj['fieldValue'] = configIndex.dataType == Number ? Number(data[configIndex.fieldValue]) : data[configIndex.fieldValue];
                                        obj['isChecked'] = false;
                                        this.tempFilter[key].push(obj);
                                    }
                                    else if (configIndex.filterType == 'range_slider') {
                                        this.tempFilter[key]['filterByLowValue'] = configIndex.filterByLowValue;
                                        this.tempFilter[key]['filterByHighValue'] = configIndex.filterByHighValue;
                                        this.tempFilter[key]['rangeValue'] = [];
                                        this.tempFilter[key]['defaultRangeValue'] = [];
                                        this.tempFilter[key]['dropDownRangeValues'] = [];
                                        let min = Number(data[configIndex.lowValueFieldValue]);
                                        let max = Number(data[configIndex.highValueFieldValue]);
                                        this.tempFilter[key]['minValue'] = min;
                                        this.tempFilter[key]['maxValue'] = max;
                                        this.tempFilter[key]['rangeValue'].push(min);
                                        this.tempFilter[key]['rangeValue'].push(max);
                                        this.tempFilter[key]['defaultRangeValue'].push(min);
                                        this.tempFilter[key]['defaultRangeValue'].push(max);
                                        this.tempFilter[key]['dropDownRangeValues'].push(min);
                                        this.tempFilter[key]['dropDownRangeValues'].push(max);
                                        let step = configIndex.step || 100;
                                        this.tempFilter[key]['dropdown'] = [];
                                        this.tempFilter[key]['rangeStep'] = configIndex.step * 2; //(min + max) / step;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    sortCheckBoxesFilter() {
        for (let j = this.config.filter.filterParameter.length - 1; j >= 0; j--) {
            if (this.config.filter.filterParameter[j].isShowFilter) {
                if (this.tempFilter.hasOwnProperty(this.config.filter.filterParameter[j].filterBy)) {
                    if (this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterValuesSorting
                        && this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterSortDirection
                        && this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterType == 'checkBoxes') {
                        let sortDirection = _.lowerCase(this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterSortDirection);
                        sortDirection = sortDirection == 'asc' ? sortDirection : 'desc';
                        let direction = [];
                        direction.push(sortDirection);
                        let pickArray = _.pick(this.tempFilter[this.config.filter.filterParameter[j].filterBy], ['filterTitle', 'isShowFilter', 'filterBy', 'filterValuesSorting',
                            'filterSortDirection', 'isShowMore', 'filterCheckBoxLimit', 'filterType']);
                        const sorted = _.orderBy(this.tempFilter[this.config.filter.filterParameter[j].filterBy], ['fieldValue'], direction);
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy] = sorted;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['filterTitle'] = pickArray.filterTitle;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['isShowFilter'] = pickArray.isShowFilter;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['filterBy'] = pickArray.filterBy;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['filterValuesSorting'] = pickArray.filterValuesSorting;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['filterSortDirection'] = pickArray.filterSortDirection;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['isShowMore'] = false;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['filterCheckBoxLimit'] = pickArray.filterCheckBoxLimit;
                        this.tempFilter[this.config.filter.filterParameter[j].filterBy]['filterType'] = pickArray.filterType;
                    }
                }
            }
        }
    }
    applyFilter() {
        // Assign the original array without any filter to the newLots
        var newLots = this.data;
        // Check the searchText is not undefined and then search the by provided fields.
        if (this.searchText !== undefined) {
            this.searchText = this.searchText.toLocaleLowerCase();
            var mainSearchArray = [];
            // Search In the all fields given in the config of the search.
            for (let j = this.config.search.searchParameter.length - 1; j >= 0; j--) {
                let searchArray = [];
                searchArray = this.data.filter((it) => {
                    if (it[this.config.search.searchParameter[j].searchBy] != null && it[this.config.search.searchParameter[j].searchBy] != undefined) {
                        return it[this.config.search.searchParameter[j].searchBy].toLocaleLowerCase().includes(this.searchText);
                    }
                });
                // Push the each search result...
                if (searchArray.length > 0) {
                    mainSearchArray.push(...searchArray);
                }
                // Assign the searched Array to the lots Array.
                newLots = mainSearchArray;
            }
        }
        var allSelectedCheckBoxesArray = [];
        var allSelectedRangeFilterArray = [];
        // Check the config for the filter....
        for (let j = this.config.filter.filterParameter.length - 1; j >= 0; j--) {
            // Check the status of the filter
            if (this.config.filter.filterParameter[j].isShowFilter) {
                if (this.tempFilter.hasOwnProperty(this.config.filter.filterParameter[j].filterBy) && this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterType == 'checkBoxes') {
                    // Filter the checked Values
                    this.selectedLotStatusFilter = this.tempFilter[this.config.filter.filterParameter[j].filterBy].filter((value, index) => {
                        return value.isChecked;
                    });
                    // Push the all checked values in same array
                    allSelectedCheckBoxesArray.push(this.selectedLotStatusFilter);
                }
                else if (this.tempFilter.hasOwnProperty(this.config.filter.filterParameter[j].filterBy) && this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterType == 'range_slider') {
                    // If filter type is the Range filter then push the data in the range filter.
                    allSelectedRangeFilterArray.push(this.tempFilter[this.config.filter.filterParameter[j].filterBy]);
                }
            }
        }
        let singleTypeFilterArray = [];
        this.allSelectedFilters = allSelectedCheckBoxesArray;
        //Filter the data based on checkboxes
        if (allSelectedCheckBoxesArray.length > 0) {
            // Filter the each array at a time, In config multiple filters.
            singleTypeFilterArray = this.filterSingle(newLots, allSelectedCheckBoxesArray);
            newLots = singleTypeFilterArray;
        }
        else {
            newLots = newLots;
        }
        let singleRangeSliderFilter = [];
        // Filter the data based on the range filter.
        if (allSelectedRangeFilterArray.length > 0) {
            // Filter the each array at a time, In config multiple filters.
            singleRangeSliderFilter = this.filterSingleRangeFilter(newLots, allSelectedRangeFilterArray);
            newLots = singleRangeSliderFilter;
        }
        else {
            newLots = newLots;
        }
        this.filterData = [];
        this.filterData = newLots;
        // Check the Sorting is applied if Yes then sort the array after filter.
        if (this.isSorted) {
            //this.sortLots();
        }
        else {
            this.filteredData.emit(this.filterData);
        }
    }
    filterSingle(data, selectedCheckBoxesArrays) {
        for (let k = selectedCheckBoxesArrays.length - 1; k >= 0; k--) {
            var newData = [];
            if (selectedCheckBoxesArrays[k].length > 0) {
                data = this.filterArrayBasedOnCheckBoxes(data, selectedCheckBoxesArrays[k]);
                if (data.length > 0) {
                    newData.push(...data);
                    data = newData;
                }
                else {
                    data = [];
                }
            }
        }
        return this.uniqueValuesInArray(data);
    }
    filterSingleRangeFilter(data, selectedRangeFilterArrays) {
        for (let k = selectedRangeFilterArrays.length - 1; k >= 0; k--) {
            var newData = [];
            if (_.isObject(selectedRangeFilterArrays[k])) {
                data = this.filterArrayRangeFilter(data, selectedRangeFilterArrays[k]);
                if (data.length > 0) {
                    newData.push(...data);
                    data = newData;
                }
                else {
                    data = [];
                }
            }
        }
        return this.uniqueValuesInArray(data);
    }
    filterArrayBasedOnCheckBoxes(lotsArray, selectedCheckBoxesArrays) {
        var filtered = [];
        for (var lots in lotsArray) {
            if (selectedCheckBoxesArrays.length > 0) {
                selectedCheckBoxesArrays.forEach((element) => {
                    if (lotsArray[lots][element.filterBy] == element.fieldValue) {
                        if (filtered.length > 0) {
                            filtered.push(lotsArray[lots]);
                        }
                        else {
                            filtered.push(lotsArray[lots]);
                        }
                    }
                });
            }
        }
        return this.uniqueValuesInArray(filtered);
    }
    uniqueValuesInArray(data) {
        const uniqueValues = data.filter((element, index) => data.findIndex((obj) => obj[this.config.filter.uniqueColumn] == element[this.config.filter.uniqueColumn]) == index);
        return uniqueValues;
    }
    filterArrayRangeFilter(lotsArray, rangeFilterArrays) {
        var filtered = [];
        for (var lots in lotsArray) {
            let min = rangeFilterArrays.rangeValue[0];
            let max = rangeFilterArrays.rangeValue[1];
            let minValueIndex = Number(lotsArray[lots][rangeFilterArrays.filterByLowValue]);
            let maxValueIndex = Number(lotsArray[lots][rangeFilterArrays.filterByHighValue]);
            if ((minValueIndex >= min && minValueIndex <= max && maxValueIndex >= min && maxValueIndex <= max)) {
                filtered.push(lotsArray[lots]);
            }
        }
        return this.uniqueValuesInArray(filtered);
    }
    clearSingleFilters(filterBy, filterType) {
        if (filterBy && filterType == 'checkBoxes') {
            this.unCheckedCheckBoxes(this.tempFilter[filterBy]);
        }
        else if (filterBy && filterType == 'range_slider') {
            this.clearRangeSliderFilter(this.tempFilter[filterBy]);
        }
        this.applyFilter();
    }
    clearAllFilters() {
        this.filterData = [];
        this.sort = this.defaultSort;
        this.searchText = this.defaultSearch;
        for (let j = this.config.filter.filterParameter.length - 1; j >= 0; j--) {
            if (this.config.filter.filterParameter[j].isShowFilter) {
                if ((this.tempFilter.hasOwnProperty(this.config.filter.filterParameter[j].filterBy) &&
                    (this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterType === 'checkBoxes'))) {
                    this.unCheckedCheckBoxes(this.tempFilter[this.config.filter.filterParameter[j].filterBy]);
                }
                else if ((this.tempFilter.hasOwnProperty(this.config.filter.filterParameter[j].filterBy) &&
                    (this.tempFilter[this.config.filter.filterParameter[j].filterBy].filterType === 'range_slider'))) {
                    this.clearRangeSliderFilter(this.tempFilter[this.config.filter.filterParameter[j].filterBy]);
                }
            }
        }
        this.filterData = this.data;
        this.filteredData.emit(this.filterData);
    }
    unCheckedCheckBoxes(data) {
        data.forEach((element) => {
            element.isChecked = false;
        });
    }
    clearRangeSliderFilter(data) {
        data.rangeValue = data.defaultRangeValue;
        data.dropDownRangeValues = [];
        data.dropDownRangeValues = data.defaultRangeValue;
    }
    showMoreItems(filterBy, showStatus) {
        if (showStatus) {
            this.tempFilter[filterBy]['filterCheckBoxLimit'] = this.tempFilter[filterBy].length;
            this.tempFilter[filterBy]['isShowMore'] = true;
        }
        else if (!showStatus) {
            this.tempFilter[filterBy]['isShowMore'] = false;
        }
    }
    rangeDropDownOnChange(data) {
        data.rangeValue = data.dropDownRangeValues;
        this.applyFilter();
    }
    sliderChange(data) {
        data.dropDownRangeValues = data.rangeValue;
    }
}
NgxFilterSearchComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-filter-search',
                template: "<div class=\"row\" *ngIf=\"data && config\">\n  <div class=\"col-sm-12\">\n     <div class=\"row pt-1 pb-1\">\n       <div class=\"col-sm-6\">\n\n       </div>\n       <div class=\"col-sm-6\">\n         <h6 class=\"float-right cursor-pointer text-primary\" (click)=\"clearAllFilters()\">Clear All</h6>\n       </div>\n     </div>\n      <div *ngIf=\"config?.search?.isSearchShow\" class=\"pt-1 pb-1\">\n        <strong class=\"pt-2 pb-2 font-weight-bold text-capitalize\">Search</strong>\n          <div class=\"input-group pt-1\">\n            <div class=\"form-outline\">\n              <input type=\"text\" id=\"form1\" class=\"form-control\" [(ngModel)]=\"searchText\" placeholder=\"Search Keyword...\" (keyup)=\"applyFilter()\"/>\n            </div>\n          </div>\n      </div>\n      <hr>\n      <div *ngIf=\"config?.filter?.isShowFilter && tempFilter\">\n        <div *ngFor=\"let config of config.filter.filterParameter; let i = index;let last = last;\">\n            <div *ngIf=\"config?.isShowFilter && tempFilter[config.filterBy]\">\n              <div class=\"row pt-1 pb-1\" *ngIf=\"(((!config?.minimumShowLimit && tempFilter[config.filterBy].length > 0) || (tempFilter[config.filterBy].length > config?.minimumShowLimit && config?.isShowFilter && config?.filterType == 'checkBoxes' && tempFilter[config.filterBy].length > 0)) || (config?.filterType == 'range_slider' && tempFilter[config.filterBy].maxValue > 0 ))\">\n                <div class=\"col-sm-8 float-left\">\n                  <strong class=\"font-weight-bold\">{{ tempFilter[config.filterBy]?.filterTitle}}</strong>\n                </div>\n                <div class=\"col-sm-4\">\n                  <h6 class=\"float-right cursor-pointer text-primary clear\" (click)=\"clearSingleFilters(tempFilter[config.filterBy].filterBy,tempFilter[config.filterBy].filterType)\">Clear</h6>\n                </div>\n              </div>\n              <div *ngIf=\"(config?.isShowFilter && config?.filterType == 'checkBoxes' && (!config?.minimumShowLimit || (tempFilter[config.filterBy].length > config?.minimumShowLimit))) \">\n                <div class=\"\" *ngFor=\"let filter of tempFilter[config.filterBy] | slice : 0:(!tempFilter[config.filterBy].isShowMore ? config.filterCheckBoxLimit : tempFilter[config.filterBy].filterCheckBoxLimit); let i = index\">\n                  <input type=\"checkbox\" [id]=\"filter.fieldName\" [name]=\"filter.fieldName\" [value]=\"filter.fieldValue\" [(ngModel)]=\"filter.isChecked\" (change)=\"applyFilter()\">\n                  <span class=\"pl-2 font-small\">\n                    {{filter.fieldName}}\n                  </span>\n                </div>\n                <div *ngIf=\"tempFilter[config.filterBy].length > config?.filterCheckBoxLimit \">\n                  <h6 class=\"cursor-pointer text-primary pt-1\" *ngIf =\"!tempFilter[config.filterBy].isShowMore\" (click)=\"showMoreItems(tempFilter[config.filterBy].filterBy,true)\">\n                  {{ tempFilter[config.filterBy].length - config.filterCheckBoxLimit }} More\n                  </h6>\n                  <h6 class=\"cursor-pointer text-primary pt-1\" *ngIf =\"tempFilter[config.filterBy].isShowMore\" (click)=\"showMoreItems(tempFilter[config.filterBy].filterBy, false)\">\n                    Show Less\n                  </h6>\n                </div>\n            </div>\n            <div *ngIf=\"config?.isShowFilter && config?.filterType == 'range_slider' && tempFilter[config.filterBy].maxValue > 0\">\n              <!-- (change)=\"loanChange($event)\" \n               [ticks]=\"tempFilter[config.filterBy].ticks\" \n               [ticks]=\"tempFilter[config.filterBy].ticks\"\n              -->\n              <!-- {{tempFilter[config.filterBy].ticks | json}} -->\n              <!-- {{tempFilter[config.filterBy]  | json}} -->\n              <!-- {{tempFilter[config.filterBy].minValue}} -->\n              <!-- {{tempFilter[config.filterBy | json}} -->\n              <!-- [ticks]=\"tempFilter[config.filterBy].ticks\" \n                [tooltip]=\"tempFilter[config.filterBy].tooltip\"\n                 [ticks]=\"tempFilter[config.filterBy].ticks\"\n                 [tooltip]=\"tempFilter[config.filterBy].tooltip\"\n              --> \n              <!-- [ticks]=\"tempFilter[config.filterBy].ticks\" -->\n              <span class=\"min\">\n                <span>\n                  {{tempFilter[config.filterBy].rangeValue[0]}} - {{tempFilter[config.filterBy].rangeValue[1]}}\n                </span>\n              </span>\n              <ejs-slider\n                id=\"range\"\n                [(value)]=\"tempFilter[config.filterBy].rangeValue\"\n                [min]=\"tempFilter[config.filterBy].minValue\"\n                [max]=\"tempFilter[config.filterBy].maxValue\"\n                [step]=\"tempFilter[config.filterBy].rangeStep\"\n                [type]=\"'Range'\"\n                (change)=\"sliderChange(tempFilter[config?.filterBy])\"\n                (changed)=\"applyFilter()\">\n                </ejs-slider>\n                 <!-- <div class=\"row\">\n                  <div class=\"col-sm-6\">\n                    <span class=\"float-left min\">\u20B9 {{tempFilter[config.filterBy].minValue}}</span>\n                  </div>\n                  <div class=\"col-sm-6\">\n                    <span class=\"float-right min\">\u20B9 {{tempFilter[config.filterBy].maxValue}}</span>\n                  </div>\n                 </div> -->\n                <!-- <div class=\"row\" *ngIf=\"tempFilter[config.filterBy].dropdown.length > 0\">\n                    <div class=\"col-sm-6 \">\n                        <div class=\"pt-1\">\n                          <select class=\"browser-default custom-select float-right range-select\" \n                            [(ngModel)]=\"tempFilter[config.filterBy].dropDownRangeValues[0]\"\n                            (change)=\"rangeDropDownOnChange(tempFilter[config.filterBy])\">\n                            <option\n                            *ngFor=\"let value of tempFilter[config.filterBy].dropdown\"\n                            [ngValue]=\"value\"\n                            >\n                            {{ value | currencyLocal:'INR'}}\n                            </option>\n                          </select>\n                        </div>\n                    </div>\n                    <div class=\"col-sm-6 \">\n                        <div class=\"pt-1\">\n                          <select class=\"browser-default custom-select float-right range-select\"\n                          [(ngModel)]=\"tempFilter[config.filterBy].dropDownRangeValues[1]\"\n                          (change)=\"rangeDropDownOnChange(tempFilter[config.filterBy])\">\n                            <option\n                            *ngFor=\"let value of tempFilter[config.filterBy].dropdown\"\n                             [ngValue]=\"value\"\n                            >\n                            {{ value | currencyLocal:'INR'}}\n                            </option>\n                          </select>\n                        </div>\n                    </div>\n                </div> -->\n              </div>\n            <hr *ngIf=\"(!last && ((!config?.minimumShowLimit || (tempFilter[config.filterBy].length > config?.minimumShowLimit && config?.isShowFilter && config?.filterType == 'checkBoxes')) || (config?.filterType == 'range_slider')))\">\n          </div>\n        </div>\n      </div>\n  </div>\n</div>\n",
                styles: [""]
            },] }
];
NgxFilterSearchComponent.ctorParameters = () => [];
NgxFilterSearchComponent.propDecorators = {
    data: [{ type: Input }],
    config: [{ type: Input }],
    filteredData: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWZpbHRlci1zZWFyY2guY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWZpbHRlci1zZWFyY2gvc3JjL2xpYi9uZ3gtZmlsdGVyLXNlYXJjaC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMvRSxPQUFPLEtBQUssQ0FBQyxNQUFNLFFBQVEsQ0FBQztBQVE1QixNQUFNLE9BQU8sd0JBQXdCO0lBb0JuQztRQWpCVSxpQkFBWSxHQUFzQixJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3hELGVBQVUsR0FBUSxFQUFFLENBQUM7UUFHckIsdUJBQWtCLEdBQVEsRUFBRSxDQUFDO1FBQzdCLFdBQU0sR0FBRyxLQUFLLENBQUM7UUFDZixTQUFJLEdBQUcsZ0JBQWdCLENBQUM7UUFDeEIsYUFBUSxHQUFZLEtBQUssQ0FBQztRQUMxQixrQkFBYSxHQUFHLEtBQUssQ0FBQztRQUN0QixnQkFBVyxHQUFHLGdCQUFnQixDQUFDO1FBQy9CLGtCQUFhLEdBQUcsRUFBRSxDQUFDO1FBR25CLFVBQUssR0FBVyxFQUFFLENBQUM7UUFDbkIsWUFBTyxHQUFXLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsQ0FBQztRQUM3RSxVQUFLLEdBQVcsRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFDM0YsU0FBSSxHQUFXLEVBQUUsQ0FBQztJQUNULENBQUM7SUFFakIsUUFBUTtRQUNOLElBQUcsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQzNCLElBQUks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QUVELHNCQUFzQixDQUFDLElBQVM7UUFDOUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUM7UUFDekMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEVBQUUsQ0FBQztRQUM5QixJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDO0lBQ3BELENBQUM7SUFFRCxhQUFhLENBQUMsUUFBZ0IsRUFBQyxVQUFtQjtRQUNoRCxJQUFHLFVBQVUsRUFBRTtZQUNiLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUMscUJBQXFCLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUNwRixJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFlBQVksQ0FBQyxHQUFHLElBQUksQ0FBQztTQUNoRDthQUFNLElBQUcsQ0FBQyxVQUFVLEVBQUU7WUFDckIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxZQUFZLENBQUMsR0FBRyxLQUFLLENBQUM7U0FDakQ7SUFDSCxDQUFDO0lBR0QscUJBQXFCLENBQUMsSUFBUztRQUM3QixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQztRQUMzQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDckIsQ0FBQztJQUVELFlBQVksQ0FBQyxJQUFxQjtRQUNoQyxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQTtJQUM1QyxDQUFDOzs7WUFoYUYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxtQkFBbUI7Z0JBRTdCLGkxT0FBaUQ7O2FBQ2xEOzs7O21CQUdFLEtBQUs7cUJBQ0wsS0FBSzsyQkFDTCxNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBFdmVudEVtaXR0ZXIsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtZmlsdGVyLXNlYXJjaCcsXG4gIHN0eWxlVXJsczogWycuL25neC1maWx0ZXItc2VhcmNoLmNvbXBvbmVudC5zY3NzJ10sXG4gIHRlbXBsYXRlVXJsOiAnLi9uZ3gtZmlsdGVyLXNlYXJjaC5jb21wb25lbnQuaHRtbCcsXG59KVxuXG5leHBvcnQgY2xhc3MgTmd4RmlsdGVyU2VhcmNoQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KCkgZGF0YTogYW55O1xuICBASW5wdXQoKSBjb25maWc6IGFueTtcbiAgQE91dHB1dCgpIGZpbHRlcmVkRGF0YTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIHB1YmxpYyB0ZW1wRmlsdGVyOiBhbnkgPSB7fTtcbiAgcHVibGljIHNlYXJjaFRleHQ6IGFueTtcbiAgcHVibGljIGZpbHRlckRhdGE6IGFueTtcbiAgcHVibGljIGFsbFNlbGVjdGVkRmlsdGVyczogYW55ID0gW107XG4gIHB1YmxpYyBmaWx0ZXIgPSAnYWxsJztcbiAgcHVibGljIHNvcnQgPSAnbG90X251bWJlcl9sb3cnO1xuICBwdWJsaWMgaXNTb3J0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHVibGljIGRlZmF1bHRGaWx0ZXIgPSAnYWxsJztcbiAgcHVibGljIGRlZmF1bHRTb3J0ID0gJ2xvdF9udW1iZXJfbG93JztcbiAgcHVibGljIGRlZmF1bHRTZWFyY2ggPSAnJztcbiAgcHVibGljIHNlbGVjdGVkTG90U3RhdHVzRmlsdGVyOiBhbnk7XG5cbiAgcHVibGljIHZhbHVlOiBudW1iZXIgPSAzMDtcbiAgcHVibGljIHRvb2x0aXA6IE9iamVjdCA9IHsgcGxhY2VtZW50OiAnQmVmb3JlJywgaXNWaXNpYmxlOiB0cnVlLCBzaG93T246ICdBbHdheXMnIH07XG4gIHB1YmxpYyB0aWNrczogT2JqZWN0ID0geyBwbGFjZW1lbnQ6ICdBZnRlcicsIGxhcmdlU3RlcDogMjAsIHNtYWxsU3RlcDogMTAsIHNob3dTbWFsbFRpY2tzOiB0cnVlIH07XG4gIHB1YmxpYyBzdGVwOiBudW1iZXIgPSA1MDtcbiAgY29uc3RydWN0b3IoKSB7IH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICBpZih0aGlzLmRhdGEgJiYgdGhpcy5jb25maWcpIHtcbiAgICAgIHRoaXMuc2V0RmlsdGVyQ29uZmlnKHRoaXMuZGF0YSk7XG4gICAgICB0aGlzLmZpbHRlckRhdGEgPSB0aGlzLmRhdGE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdwbGVhc2UgQWRkIHRoZSBkYXRhIGFuZCBjb25maWcnKVxuICAgIH1cbiAgfVxuXG4gIHNldEZpbHRlckNvbmZpZyhkYXRhOiBhbnkpIHtcbiAgICBmb3IgKGxldCBpID0gZGF0YS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgbGV0IHN0YXR1c05hbWU7XG4gICAgICBkYXRhW2ldWydzdGF0dXNOYW1lJ10gPSBzdGF0dXNOYW1lO1xuICAgICAgLy8gQ3JlYXRlIHRoZSBrZXkgZm9yIHRoZSBjdXN0b20gZmllbGRzLi4uLiBBZGQgdGhlIGN1c3RvbV8gYmVmb3JlIGVhY2ggY3VzdG9tIGZpbGVkIG5hbWUuLi5cbiAgICAgIGlmIChkYXRhW2ldLmN1c3RvbUZpZWxkcyAmJiAhXy5pc0VtcHR5KGRhdGFbaV0uY3VzdG9tRmllbGRzKSkge1xuICAgICAgICBjb25zdCBjdXN0b21GaWVsZHMgPSBkYXRhW2ldLmN1c3RvbUZpZWxkcztcbiAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gaW4gY3VzdG9tRmllbGRzKSB7XG4gICAgICAgICAgICBpZiAoY3VzdG9tRmllbGRzW2l0ZW1dLnNob3dGaWx0ZXIpIHtcbiAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSB1bmlxdWUga2V5IGZvciB0aGUgY3VzdG9tIGZpZWxkcy5cbiAgICAgICAgICAgICBsZXQga2V5ID0gJ2N1c3RvbV8nK2l0ZW07XG4gICAgICAgICAgICAgLy8gQ2hhbmdlIHRoZSBjb25maWcgZm9yIHRoZSB0aGUgZGlzcGxheSBuYW1lIHdhbnQgdG8gc2hvdyBkaWZmZXJlbnQuXG4gICAgICAgICAgICAgIGNvbnN0IGMgPSBfLmdldCh0aGlzLmNvbmZpZy5maWVsZHNDb25maWdDdXN0b21DaGFuZ2VzLCBrZXkpXG4gICAgICAgICAgICAgIGlmKGMpIHtcbiAgICAgICAgICAgICAgICAvLyBDb2RlIGZvciBhZGRpbmcgdGhlIGVtcHR5IGRhdGEgYXMgdGhlIG5vdCBkYXRlZCBsb3RzLi4uLlxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gY3VzdG9tRmllbGRzW2l0ZW1dLnZhbHVlID09IGMudmFsdWUgPyBjLnJlcGxhY2VWYWx1ZSA6IGN1c3RvbUZpZWxkc1tpdGVtXS52YWx1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gIGN1c3RvbUZpZWxkc1tpdGVtXS52YWx1ZSA9PSBjLnZhbHVlID8gYy5kaXNwbGF5TmFtZSA6IGN1c3RvbUZpZWxkc1tpdGVtXS52YWx1ZTtcbiAgICAgICAgICAgICAgICBkYXRhW2ldWydjdXN0b21fJytjdXN0b21GaWVsZHNbaXRlbV0ubmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBkYXRhW2ldWydjdXN0b21fZGlzcGxheV8nK2N1c3RvbUZpZWxkc1tpdGVtXS5uYW1lXSA9IG5hbWU7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGF0YVtpXVsnY3VzdG9tXycrY3VzdG9tRmllbGRzW2l0ZW1dLm5hbWVdID0gY3VzdG9tRmllbGRzW2l0ZW1dLnZhbHVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLnNldENoZWNrQm94RmlsdGVyKGRhdGFbaV0pO1xuICAgIH1cbiAgICB0aGlzLnNvcnRDaGVja0JveGVzRmlsdGVyKCk7XG4gIH1cbiAgc2V0Q2hlY2tCb3hGaWx0ZXIoZGF0YTogYW55KSB7XG4gICAgLy8gQ2hlY2tlZCB0aGUgZmlsdGVyIHBhcmFtZXRlclxuICAgIGlmKHRoaXMuY29uZmlnLmZpbHRlciAmJiB0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyICkge1xuICAgICAgZm9yKGxldCBqID0gdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlci5sZW5ndGggLTE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgIHZhciBjb25maWdJbmRleCA9IHRoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal07XG4gICAgICAgIGlmIChjb25maWdJbmRleC5pc1Nob3dGaWx0ZXIpIHtcbiAgICAgICAgICB2YXIga2V5ID0gY29uZmlnSW5kZXguZmlsdGVyQnk7XG4gICAgICAgICAgdmFyIGlzUmFuZ2VGaWx0ZXJXaXRoRGlmZlZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoY29uZmlnSW5kZXgubG93VmFsdWVGaWVsZFZhbHVlKSAmJiAgZGF0YS5oYXNPd25Qcm9wZXJ0eShjb25maWdJbmRleC5oaWdoVmFsdWVGaWVsZFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlzUmFuZ2VGaWx0ZXJXaXRoRGlmZlZhbHVlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaXNSYW5nZUZpbHRlcldpdGhEaWZmVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoa2V5KSB8fCBpc1JhbmdlRmlsdGVyV2l0aERpZmZWYWx1ZSkge1xuICAgICAgICAgICAgIGlmICh0aGlzLnRlbXBGaWx0ZXIuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgaWYgKChkYXRhW2NvbmZpZ0luZGV4LmZpZWxkTmFtZV0gJiYgZGF0YVtjb25maWdJbmRleC5maWVsZFZhbHVlXSkgfHwgKGlzUmFuZ2VGaWx0ZXJXaXRoRGlmZlZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGxldCBvYmo6IGFueSA9IHt9O1xuICAgICAgICAgICAgICAgIGlmIChjb25maWdJbmRleC5maWx0ZXJUeXBlID09ICdjaGVja0JveGVzJykge1xuICAgICAgICAgICAgICAgICAgb2JqWydmaWx0ZXJCeSddID0ga2V5O1xuICAgICAgICAgICAgICAgICAgb2JqWydmaWVsZE5hbWUnXSA9IGRhdGFbY29uZmlnSW5kZXguZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICAgIG9ialsnZmllbGRWYWx1ZSddID0gIGNvbmZpZ0luZGV4LmRhdGFUeXBlID09IE51bWJlciA/ICBOdW1iZXIoZGF0YVtjb25maWdJbmRleC5maWVsZFZhbHVlXSk6IGRhdGFbY29uZmlnSW5kZXguZmllbGRWYWx1ZV07XG4gICAgICAgICAgICAgICAgICBvYmpbJ2lzQ2hlY2tlZCddID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBvYmpbJ2ZpZWxkVmFsdWUnXSwgJ09CSiBGSUVMRFMgVkFMVUUnKVxuICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgdmFyIGlzUHJlc2VudCA9IHRoaXMudGVtcEZpbHRlcltrZXldLnNvbWUoZnVuY3Rpb24oZWw6IGFueSl7IHJldHVybiBlbFsnZmllbGRWYWx1ZSddID09IGRhdGFbc2VsZi5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWVsZFZhbHVlXX0pO1xuICAgICAgICAgICAgICAgICAgaWYgKCFpc1ByZXNlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi50ZW1wRmlsdGVyW3NlbGYuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29uZmlnSW5kZXguZmlsdGVyVHlwZSA9PSAncmFuZ2Vfc2xpZGVyJykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgcHJldmlvdXNNaW4gPSB0aGlzLnRlbXBGaWx0ZXJba2V5XS5taW5WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHByZXZpb3VzTWF4ID0gdGhpcy50ZW1wRmlsdGVyW2tleV0ubWF4VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50TWluVmFsdWUgPSAgTnVtYmVyKGRhdGFbY29uZmlnSW5kZXgubG93VmFsdWVGaWVsZFZhbHVlXSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50TWF4VmFsdWUgPSAgTnVtYmVyKGRhdGFbY29uZmlnSW5kZXguaGlnaFZhbHVlRmllbGRWYWx1ZV0pO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbWluID0gcHJldmlvdXNNaW4gPCBjdXJyZW50TWluVmFsdWUgPyBwcmV2aW91c01pbiA6IGN1cnJlbnRNaW5WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1heCA9IHByZXZpb3VzTWF4ID4gY3VycmVudE1heFZhbHVlID8gcHJldmlvdXNNYXggOiBjdXJyZW50TWF4VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydtaW5WYWx1ZSddID0gbWluO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnbWF4VmFsdWUnXSA9IG1heDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ3JhbmdlVmFsdWUnXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZGVmYXVsdFJhbmdlVmFsdWUnXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZHJvcERvd25SYW5nZVZhbHVlcyddID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydyYW5nZVZhbHVlJ10ucHVzaChtaW4pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsncmFuZ2VWYWx1ZSddLnB1c2gobWF4KTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNtYWxsU3RlcCA9IGNvbmZpZ0luZGV4LnN0ZXAgPyAoY29uZmlnSW5kZXguc3RlcCAqIDIpIDogMTAwXG4gICAgICAgICAgICAgICAgICAgIGxldCBsYXJnZVN0ZXAgPSBjb25maWdJbmRleC5zdGVwIHx8IDUwO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGlmZiA9IG1heCAtIG1pbjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ3NtYWxsU3RlcCddID0gZGlmZiAvIHNtYWxsU3RlcCA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydsYXJnZVN0ZXAnXSA9IGRpZmYgLyBsYXJnZVN0ZXAgO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsndGlja3MnXSA9IHsgcGxhY2VtZW50OiAnQWZ0ZXInLCBsYXJnZVN0ZXA6IGRpZmYgLyBsYXJnZVN0ZXAgICwgc21hbGxTdGVwOiBkaWZmIC8gc21hbGxTdGVwLCBzaG93U21hbGxUaWNrczogdHJ1ZSwgc2hvd0xhcmdlVGlja3M6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydkZWZhdWx0UmFuZ2VWYWx1ZSddLnB1c2gobWluKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2RlZmF1bHRSYW5nZVZhbHVlJ10ucHVzaChtYXgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZHJvcERvd25SYW5nZVZhbHVlcyddLnB1c2gobWluKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2Ryb3BEb3duUmFuZ2VWYWx1ZXMnXS5wdXNoKG1heCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydyYW5nZVN0ZXAnXSA9IHNtYWxsU3RlcCAvL2RpZmYgLyBzbWFsbFN0ZXA7XG4gICAgICAgICAgICAgICAgICAvLyAgIGZpbHRlckFycmF5UmFuZ2VGaWx0ZXJcbiAgICAgICAgICAgICAgICAgIC8vIHNob3dPbjogJ0Fsd2F5cydcbiAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydkcm9wZG93biddID0gW107XG4gICAgICAgICAgICAgICAgICBsZXQgZHJvcGRvd25WYWx1ZSA9IG1pbjtcbiAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8PSBzbWFsbFN0ZXA7IGsgKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2Ryb3Bkb3duJ10ucHVzaChkcm9wZG93blZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duVmFsdWUgPSAoZGlmZiAvIHNtYWxsU3RlcCkgKyBkcm9wZG93blZhbHVlO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZHJvcGRvd24nXSA9IF8uIHVuaXEodGhpcy50ZW1wRmlsdGVyW2tleV1bJ2Ryb3Bkb3duJ10pXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZXQgb2JqOiBhbnkgPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnSW5kZXguaXNTaG93RmlsdGVyKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoKGRhdGFbY29uZmlnSW5kZXguZmllbGROYW1lXSAmJiBkYXRhW2NvbmZpZ0luZGV4LmZpZWxkVmFsdWVdKSB8fCAoaXNSYW5nZUZpbHRlcldpdGhEaWZmVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydmaWx0ZXJUaXRsZSddID0gY29uZmlnSW5kZXguZmlsdGVyVGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydpc1Nob3dGaWx0ZXInXSA9IGNvbmZpZ0luZGV4LmlzU2hvd0ZpbHRlcjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2ZpbHRlckJ5J10gPSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydmaWx0ZXJWYWx1ZXNTb3J0aW5nJ10gPSBjb25maWdJbmRleC5maWx0ZXJWYWx1ZXNTb3J0aW5nO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZmlsdGVyU29ydERpcmVjdGlvbiddID0gY29uZmlnSW5kZXguZmlsdGVyU29ydERpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2lzU2hvd01vcmUnXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZmlsdGVyQ2hlY2tCb3hMaW1pdCddID0gY29uZmlnSW5kZXguZmlsdGVyQ2hlY2tCb3hMaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2ZpbHRlclR5cGUnXSA9IGNvbmZpZ0luZGV4LmZpbHRlclR5cGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maWdJbmRleC5maWx0ZXJUeXBlID09ICdjaGVja0JveGVzJykge1xuICAgICAgICAgICAgICAgICAgICAgIG9ialsnZmlsdGVyQnknXSA9IGtleTtcbiAgICAgICAgICAgICAgICAgICAgICBvYmpbJ2ZpZWxkTmFtZSddID0gZGF0YVtjb25maWdJbmRleC5maWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgIG9ialsnZmllbGRWYWx1ZSddID0gIGNvbmZpZ0luZGV4LmRhdGFUeXBlID09IE51bWJlciA/ICBOdW1iZXIoZGF0YVtjb25maWdJbmRleC5maWVsZFZhbHVlXSk6IGRhdGFbY29uZmlnSW5kZXguZmllbGRWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgb2JqWydpc0NoZWNrZWQnXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGNvbmZpZ0luZGV4LmZpbHRlclR5cGUgPT0gJ3JhbmdlX3NsaWRlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZmlsdGVyQnlMb3dWYWx1ZSddID0gY29uZmlnSW5kZXguZmlsdGVyQnlMb3dWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZmlsdGVyQnlIaWdoVmFsdWUnXSA9IGNvbmZpZ0luZGV4LmZpbHRlckJ5SGlnaFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydyYW5nZVZhbHVlJ10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZGVmYXVsdFJhbmdlVmFsdWUnXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydkcm9wRG93blJhbmdlVmFsdWVzJ10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICBsZXQgbWluID0gTnVtYmVyKGRhdGFbY29uZmlnSW5kZXgubG93VmFsdWVGaWVsZFZhbHVlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgbGV0IG1heCA9IE51bWJlcihkYXRhW2NvbmZpZ0luZGV4LmhpZ2hWYWx1ZUZpZWxkVmFsdWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnbWluVmFsdWUnXSA9IG1pbjtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnbWF4VmFsdWUnXSA9IG1heFxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydyYW5nZVZhbHVlJ10ucHVzaChtaW4pO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydyYW5nZVZhbHVlJ10ucHVzaChtYXgpO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydkZWZhdWx0UmFuZ2VWYWx1ZSddLnB1c2gobWluKTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZGVmYXVsdFJhbmdlVmFsdWUnXS5wdXNoKG1heCk7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2Ryb3BEb3duUmFuZ2VWYWx1ZXMnXS5wdXNoKG1pbik7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW2tleV1bJ2Ryb3BEb3duUmFuZ2VWYWx1ZXMnXS5wdXNoKG1heCk7XG4gICAgICAgICAgICAgICAgICAgICAgbGV0IHN0ZXAgPSBjb25maWdJbmRleC5zdGVwIHx8IDEwMDtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJba2V5XVsnZHJvcGRvd24nXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlcltrZXldWydyYW5nZVN0ZXAnXSA9ICBjb25maWdJbmRleC5zdGVwICogMjsvLyhtaW4gKyBtYXgpIC8gc3RlcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc29ydENoZWNrQm94ZXNGaWx0ZXIoKSB7XG4gICAgZm9yKGxldCBqID0gdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlci5sZW5ndGggLTE7IGogPj0gMDsgai0tKSB7XG4gICAgICBpZiAodGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5pc1Nob3dGaWx0ZXIpIHtcbiAgICAgICAgICAgaWYgKHRoaXMudGVtcEZpbHRlci5oYXNPd25Qcm9wZXJ0eSh0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5KSkge1xuICAgICAgICAgICAgIGlmICh0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV0uZmlsdGVyVmFsdWVzU29ydGluZ1xuICAgICAgICAgICAgICAmJiB0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV0uZmlsdGVyU29ydERpcmVjdGlvblxuICAgICAgICAgICAgICAmJiB0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV0uZmlsdGVyVHlwZSA9PSAnY2hlY2tCb3hlcydcbiAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgIGxldCBzb3J0RGlyZWN0aW9uID0gXy5sb3dlckNhc2UodGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldLmZpbHRlclNvcnREaXJlY3Rpb24pO1xuICAgICAgICAgICAgICAgICBzb3J0RGlyZWN0aW9uID0gc29ydERpcmVjdGlvbiA9PSAnYXNjJyAgPyBzb3J0RGlyZWN0aW9uIDogJ2Rlc2MnO1xuICAgICAgICAgICAgICAgICBsZXQgZGlyZWN0aW9uOiBhbnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgZGlyZWN0aW9uLnB1c2goc29ydERpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgIGxldCBwaWNrQXJyYXkgPSBfLnBpY2sodGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldLCBbJ2ZpbHRlclRpdGxlJywgJ2lzU2hvd0ZpbHRlcicsICdmaWx0ZXJCeScsICdmaWx0ZXJWYWx1ZXNTb3J0aW5nJyxcbiAgICAgICAgICAgICAgICAgJ2ZpbHRlclNvcnREaXJlY3Rpb24nLCAnaXNTaG93TW9yZScsICdmaWx0ZXJDaGVja0JveExpbWl0JywgJ2ZpbHRlclR5cGUnXSk7XG4gICAgICAgICAgICAgICAgIGNvbnN0IHNvcnRlZCA9IF8ub3JkZXJCeSh0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV0gLCBbJ2ZpZWxkVmFsdWUnXSwgZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldID0gc29ydGVkO1xuICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV1bJ2ZpbHRlclRpdGxlJ10gPSBwaWNrQXJyYXkuZmlsdGVyVGl0bGU7XG4gICAgICAgICAgICAgICAgIHRoaXMudGVtcEZpbHRlclt0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5XVsnaXNTaG93RmlsdGVyJ10gPSBwaWNrQXJyYXkuaXNTaG93RmlsdGVyO1xuICAgICAgICAgICAgICAgICB0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV1bJ2ZpbHRlckJ5J10gPXBpY2tBcnJheS5maWx0ZXJCeTtcbiAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldWydmaWx0ZXJWYWx1ZXNTb3J0aW5nJ10gPSBwaWNrQXJyYXkuZmlsdGVyVmFsdWVzU29ydGluZztcbiAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldWydmaWx0ZXJTb3J0RGlyZWN0aW9uJ10gPSBwaWNrQXJyYXkuZmlsdGVyU29ydERpcmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldWydpc1Nob3dNb3JlJ10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldWydmaWx0ZXJDaGVja0JveExpbWl0J10gPSBwaWNrQXJyYXkuZmlsdGVyQ2hlY2tCb3hMaW1pdDtcbiAgICAgICAgICAgICAgICAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldWydmaWx0ZXJUeXBlJ10gPSBwaWNrQXJyYXkuZmlsdGVyVHlwZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICB9XG5cblxuICBhcHBseUZpbHRlcigpIHtcbiAgICAvLyBBc3NpZ24gdGhlIG9yaWdpbmFsIGFycmF5IHdpdGhvdXQgYW55IGZpbHRlciB0byB0aGUgbmV3TG90c1xuICAgIHZhciBuZXdMb3RzID0gdGhpcy5kYXRhO1xuICAgICAgLy8gQ2hlY2sgdGhlIHNlYXJjaFRleHQgaXMgbm90IHVuZGVmaW5lZCBhbmQgdGhlbiBzZWFyY2ggdGhlIGJ5IHByb3ZpZGVkIGZpZWxkcy5cbiAgICAgIGlmICh0aGlzLnNlYXJjaFRleHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLnNlYXJjaFRleHQgPSB0aGlzLnNlYXJjaFRleHQudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgdmFyIG1haW5TZWFyY2hBcnJheSA9IFtdO1xuICAgICAgICAgIC8vIFNlYXJjaCBJbiB0aGUgYWxsIGZpZWxkcyBnaXZlbiBpbiB0aGUgY29uZmlnIG9mIHRoZSBzZWFyY2guXG4gICAgICAgICAgZm9yIChsZXQgaiA9IHRoaXMuY29uZmlnLnNlYXJjaC5zZWFyY2hQYXJhbWV0ZXIubGVuZ3RoIC0xOyBqID49IDA7IGotLSkge1xuICAgICAgICAgICAgbGV0IHNlYXJjaEFycmF5ID0gW11cbiAgICAgICAgICAgIHNlYXJjaEFycmF5ID0gIHRoaXMuZGF0YS5maWx0ZXIoKGl0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGl0W3RoaXMuY29uZmlnLnNlYXJjaC5zZWFyY2hQYXJhbWV0ZXJbal0uc2VhcmNoQnldICE9IG51bGwgJiYgaXRbdGhpcy5jb25maWcuc2VhcmNoLnNlYXJjaFBhcmFtZXRlcltqXS5zZWFyY2hCeV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0W3RoaXMuY29uZmlnLnNlYXJjaC5zZWFyY2hQYXJhbWV0ZXJbal0uc2VhcmNoQnldLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5jbHVkZXModGhpcy5zZWFyY2hUZXh0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gUHVzaCB0aGUgZWFjaCBzZWFyY2ggcmVzdWx0Li4uXG4gICAgICAgICAgaWYgKHNlYXJjaEFycmF5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG1haW5TZWFyY2hBcnJheS5wdXNoKC4uLnNlYXJjaEFycmF5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gQXNzaWduIHRoZSBzZWFyY2hlZCBBcnJheSB0byB0aGUgbG90cyBBcnJheS5cbiAgICAgICAgICBuZXdMb3RzID0gbWFpblNlYXJjaEFycmF5O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBhbGxTZWxlY3RlZENoZWNrQm94ZXNBcnJheSA9IFtdO1xuICAgICAgdmFyIGFsbFNlbGVjdGVkUmFuZ2VGaWx0ZXJBcnJheSA9IFtdO1xuICAgICAgLy8gQ2hlY2sgdGhlIGNvbmZpZyBmb3IgdGhlIGZpbHRlci4uLi5cbiAgICAgIGZvcihsZXQgaiA9IHRoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXIubGVuZ3RoIC0xOyBqID49IDA7IGotLSkge1xuICAgICAgICAvLyBDaGVjayB0aGUgc3RhdHVzIG9mIHRoZSBmaWx0ZXJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uaXNTaG93RmlsdGVyKSB7XG4gICAgICAgICAgaWYgKHRoaXMudGVtcEZpbHRlci5oYXNPd25Qcm9wZXJ0eSh0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5KSAmJiB0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV0uZmlsdGVyVHlwZSA9PSAnY2hlY2tCb3hlcycpIHtcbiAgICAgICAgICAgIC8vIEZpbHRlciB0aGUgY2hlY2tlZCBWYWx1ZXNcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMb3RTdGF0dXNGaWx0ZXIgPSAgdGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldLmZpbHRlcigodmFsdWU6IGFueSwgaW5kZXg6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5pc0NoZWNrZWRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBQdXNoIHRoZSBhbGwgY2hlY2tlZCB2YWx1ZXMgaW4gc2FtZSBhcnJheVxuICAgICAgICAgICAgYWxsU2VsZWN0ZWRDaGVja0JveGVzQXJyYXkucHVzaCh0aGlzLnNlbGVjdGVkTG90U3RhdHVzRmlsdGVyKTtcbiAgICAgICAgICB9IGVsc2UgaWYodGhpcy50ZW1wRmlsdGVyLmhhc093blByb3BlcnR5KHRoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnkpICYmIHRoaXMudGVtcEZpbHRlclt0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5XS5maWx0ZXJUeXBlID09ICdyYW5nZV9zbGlkZXInKSB7XG4gICAgICAgICAgICAvLyBJZiBmaWx0ZXIgdHlwZSBpcyB0aGUgUmFuZ2UgZmlsdGVyIHRoZW4gcHVzaCB0aGUgZGF0YSBpbiB0aGUgcmFuZ2UgZmlsdGVyLlxuICAgICAgICAgICAgYWxsU2VsZWN0ZWRSYW5nZUZpbHRlckFycmF5LnB1c2godGhpcy50ZW1wRmlsdGVyW3RoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IHNpbmdsZVR5cGVGaWx0ZXJBcnJheSA9IFtdO1xuICAgICAgdGhpcy5hbGxTZWxlY3RlZEZpbHRlcnMgPSBhbGxTZWxlY3RlZENoZWNrQm94ZXNBcnJheTtcbiAgICAgIC8vRmlsdGVyIHRoZSBkYXRhIGJhc2VkIG9uIGNoZWNrYm94ZXNcbiAgICAgIGlmIChhbGxTZWxlY3RlZENoZWNrQm94ZXNBcnJheS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBGaWx0ZXIgdGhlIGVhY2ggYXJyYXkgYXQgYSB0aW1lLCBJbiBjb25maWcgbXVsdGlwbGUgZmlsdGVycy5cbiAgICAgICBzaW5nbGVUeXBlRmlsdGVyQXJyYXkgPSB0aGlzLmZpbHRlclNpbmdsZShuZXdMb3RzICxhbGxTZWxlY3RlZENoZWNrQm94ZXNBcnJheSk7XG4gICAgICAgbmV3TG90cyA9IHNpbmdsZVR5cGVGaWx0ZXJBcnJheTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld0xvdHMgPSBuZXdMb3RzO1xuICAgICAgfVxuXG4gICAgICBsZXQgc2luZ2xlUmFuZ2VTbGlkZXJGaWx0ZXIgPSBbXTtcbiAgICAgIC8vIEZpbHRlciB0aGUgZGF0YSBiYXNlZCBvbiB0aGUgcmFuZ2UgZmlsdGVyLlxuICAgICAgaWYgKGFsbFNlbGVjdGVkUmFuZ2VGaWx0ZXJBcnJheS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBGaWx0ZXIgdGhlIGVhY2ggYXJyYXkgYXQgYSB0aW1lLCBJbiBjb25maWcgbXVsdGlwbGUgZmlsdGVycy5cbiAgICAgICBzaW5nbGVSYW5nZVNsaWRlckZpbHRlciA9IHRoaXMuZmlsdGVyU2luZ2xlUmFuZ2VGaWx0ZXIobmV3TG90cyAsIGFsbFNlbGVjdGVkUmFuZ2VGaWx0ZXJBcnJheSk7XG4gICAgICAgIG5ld0xvdHMgPSBzaW5nbGVSYW5nZVNsaWRlckZpbHRlcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld0xvdHMgPSBuZXdMb3RzO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmZpbHRlckRhdGEgPSBbXTtcbiAgICAgIHRoaXMuZmlsdGVyRGF0YSA9IG5ld0xvdHM7XG5cbiAgICAgIC8vIENoZWNrIHRoZSBTb3J0aW5nIGlzIGFwcGxpZWQgaWYgWWVzIHRoZW4gc29ydCB0aGUgYXJyYXkgYWZ0ZXIgZmlsdGVyLlxuICAgICAgaWYgKHRoaXMuaXNTb3J0ZWQpIHtcbiAgICAgICAgLy90aGlzLnNvcnRMb3RzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmZpbHRlcmVkRGF0YS5lbWl0KHRoaXMuZmlsdGVyRGF0YSk7XG4gICAgICB9XG4gIH1cblxuICBmaWx0ZXJTaW5nbGUoZGF0YTogYW55LCBzZWxlY3RlZENoZWNrQm94ZXNBcnJheXM6IGFueSApIHtcbiAgICBmb3IgKGxldCBrID0gc2VsZWN0ZWRDaGVja0JveGVzQXJyYXlzLmxlbmd0aCAtMTsgayA+PSAwOyBrLS0pIHtcbiAgICAgIHZhciBuZXdEYXRhID0gW107XG4gICAgICBpZiAoc2VsZWN0ZWRDaGVja0JveGVzQXJyYXlzW2tdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZGF0YSA9IHRoaXMuZmlsdGVyQXJyYXlCYXNlZE9uQ2hlY2tCb3hlcyhkYXRhLCBzZWxlY3RlZENoZWNrQm94ZXNBcnJheXNba10pXG4gICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgbmV3RGF0YS5wdXNoKC4uLmRhdGEpO1xuICAgICAgICAgIGRhdGEgPSBuZXdEYXRhO1xuICAgICAgIH0gZWxzZSB7XG4gICAgICAgICBkYXRhID0gW107XG4gICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy51bmlxdWVWYWx1ZXNJbkFycmF5KGRhdGEpO1xuICB9XG5cblxuICBmaWx0ZXJTaW5nbGVSYW5nZUZpbHRlcihkYXRhOiBhbnksIHNlbGVjdGVkUmFuZ2VGaWx0ZXJBcnJheXM6IGFueSApIHtcbiAgICBmb3IgKGxldCBrID0gc2VsZWN0ZWRSYW5nZUZpbHRlckFycmF5cy5sZW5ndGggLTE7IGsgPj0gMDsgay0tKXtcbiAgICAgIHZhciBuZXdEYXRhID0gW107XG4gICAgICBpZiAoXy5pc09iamVjdChzZWxlY3RlZFJhbmdlRmlsdGVyQXJyYXlzW2tdKSkge1xuICAgICAgICBkYXRhID0gdGhpcy5maWx0ZXJBcnJheVJhbmdlRmlsdGVyKGRhdGEsIHNlbGVjdGVkUmFuZ2VGaWx0ZXJBcnJheXNba10pO1xuICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIG5ld0RhdGEucHVzaCguLi5kYXRhKTtcbiAgICAgICAgICBkYXRhID0gbmV3RGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGF0YSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnVuaXF1ZVZhbHVlc0luQXJyYXkoZGF0YSk7XG4gIH1cblxuICBmaWx0ZXJBcnJheUJhc2VkT25DaGVja0JveGVzIChsb3RzQXJyYXk6IGFueSwgc2VsZWN0ZWRDaGVja0JveGVzQXJyYXlzOiBhbnkpIHtcbiAgICB2YXIgZmlsdGVyZWQ6IGFueSA9IFtdO1xuICAgIGZvciAodmFyIGxvdHMgaW4gbG90c0FycmF5KSB7XG4gICAgICBpZiAoc2VsZWN0ZWRDaGVja0JveGVzQXJyYXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzZWxlY3RlZENoZWNrQm94ZXNBcnJheXMuZm9yRWFjaCgoZWxlbWVudDogYW55KSA9PiB7XG4gICAgICAgICAgICBpZiAobG90c0FycmF5W2xvdHNdW2VsZW1lbnQuZmlsdGVyQnldID09IGVsZW1lbnQuZmllbGRWYWx1ZSApe1xuICAgICAgICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaChsb3RzQXJyYXlbbG90c10pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2gobG90c0FycmF5W2xvdHNdKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudW5pcXVlVmFsdWVzSW5BcnJheShmaWx0ZXJlZCk7XG4gIH1cblxuICB1bmlxdWVWYWx1ZXNJbkFycmF5KGRhdGE6IGFueSApIHtcbiAgICBjb25zdCB1bmlxdWVWYWx1ZXMgPSBkYXRhLmZpbHRlcigoZWxlbWVudDogYW55LCBpbmRleDogbnVtYmVyKSA9PlxuICAgIGRhdGEuZmluZEluZGV4KCAob2JqOiBhbnkpID0+IG9ialt0aGlzLmNvbmZpZy5maWx0ZXIudW5pcXVlQ29sdW1uXSA9PSBlbGVtZW50W3RoaXMuY29uZmlnLmZpbHRlci51bmlxdWVDb2x1bW5dKSA9PSBpbmRleCk7XG4gICAgcmV0dXJuIHVuaXF1ZVZhbHVlcztcbiAgfVxuXG5cblxuICBmaWx0ZXJBcnJheVJhbmdlRmlsdGVyIChsb3RzQXJyYXk6IGFueSwgcmFuZ2VGaWx0ZXJBcnJheXM6IGFueSkge1xuICAgIHZhciBmaWx0ZXJlZCA9IFtdO1xuICAgIGZvciAodmFyIGxvdHMgaW4gbG90c0FycmF5KSB7XG4gICAgICBsZXQgbWluID0gcmFuZ2VGaWx0ZXJBcnJheXMucmFuZ2VWYWx1ZVswXTtcbiAgICAgIGxldCBtYXggPSByYW5nZUZpbHRlckFycmF5cy5yYW5nZVZhbHVlWzFdO1xuICAgICAgbGV0IG1pblZhbHVlSW5kZXggPSBOdW1iZXIobG90c0FycmF5W2xvdHNdW3JhbmdlRmlsdGVyQXJyYXlzLmZpbHRlckJ5TG93VmFsdWVdKTtcbiAgICAgIGxldCBtYXhWYWx1ZUluZGV4ID0gTnVtYmVyKGxvdHNBcnJheVtsb3RzXVtyYW5nZUZpbHRlckFycmF5cy5maWx0ZXJCeUhpZ2hWYWx1ZV0pO1xuICAgICAgaWYgKChtaW5WYWx1ZUluZGV4ID49IG1pbiAmJiBtaW5WYWx1ZUluZGV4IDw9IG1heCAmJiBtYXhWYWx1ZUluZGV4ID49IG1pbiAmJiBtYXhWYWx1ZUluZGV4IDw9IG1heCkpe1xuICAgICAgICAgIGZpbHRlcmVkLnB1c2gobG90c0FycmF5W2xvdHNdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudW5pcXVlVmFsdWVzSW5BcnJheShmaWx0ZXJlZCk7XG4gIH1cblxuICBjbGVhclNpbmdsZUZpbHRlcnMoZmlsdGVyQnk6IHN0cmluZyAsIGZpbHRlclR5cGU/OiBhbnkpIHtcbiAgICBpZiAoZmlsdGVyQnkgJiYgZmlsdGVyVHlwZSA9PSAnY2hlY2tCb3hlcycpIHtcbiAgICAgIHRoaXMudW5DaGVja2VkQ2hlY2tCb3hlcyh0aGlzLnRlbXBGaWx0ZXJbZmlsdGVyQnldKVxuICAgIH0gZWxzZSBpZiAoZmlsdGVyQnkgJiYgZmlsdGVyVHlwZSA9PSAncmFuZ2Vfc2xpZGVyJykge1xuICAgICAgdGhpcy5jbGVhclJhbmdlU2xpZGVyRmlsdGVyKHRoaXMudGVtcEZpbHRlcltmaWx0ZXJCeV0pO1xuICAgIH1cbiAgICB0aGlzLmFwcGx5RmlsdGVyKCk7XG4gIH1cblxuICBjbGVhckFsbEZpbHRlcnMoKSB7XG4gICAgdGhpcy5maWx0ZXJEYXRhID0gW107XG4gICAgdGhpcy5zb3J0ID0gdGhpcy5kZWZhdWx0U29ydDtcbiAgICB0aGlzLnNlYXJjaFRleHQgPSB0aGlzLmRlZmF1bHRTZWFyY2g7XG4gICAgZm9yKGxldCBqID0gdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlci5sZW5ndGggLTE7IGogPj0gMDsgai0tKSB7XG4gICAgICBpZiAodGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5pc1Nob3dGaWx0ZXIpIHtcbiAgICAgICAgICAgaWYgKCh0aGlzLnRlbXBGaWx0ZXIuaGFzT3duUHJvcGVydHkodGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeSkgJiZcbiAgICAgICAgICAgKHRoaXMudGVtcEZpbHRlclt0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5XS5maWx0ZXJUeXBlID09PSAnY2hlY2tCb3hlcycpKSkge1xuICAgICAgICAgICAgdGhpcy51bkNoZWNrZWRDaGVja0JveGVzKHRoaXMudGVtcEZpbHRlclt0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5XSk7XG4gICAgICAgICAgfSBlbHNlIGlmICgodGhpcy50ZW1wRmlsdGVyLmhhc093blByb3BlcnR5KHRoaXMuY29uZmlnLmZpbHRlci5maWx0ZXJQYXJhbWV0ZXJbal0uZmlsdGVyQnkpICYmXG4gICAgICAgICAgICh0aGlzLnRlbXBGaWx0ZXJbdGhpcy5jb25maWcuZmlsdGVyLmZpbHRlclBhcmFtZXRlcltqXS5maWx0ZXJCeV0uZmlsdGVyVHlwZSA9PT0gJ3JhbmdlX3NsaWRlcicpKSkge1xuICAgICAgICAgICAgdGhpcy5jbGVhclJhbmdlU2xpZGVyRmlsdGVyKHRoaXMudGVtcEZpbHRlclt0aGlzLmNvbmZpZy5maWx0ZXIuZmlsdGVyUGFyYW1ldGVyW2pdLmZpbHRlckJ5XSlcbiAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgdGhpcy5maWx0ZXJEYXRhID0gdGhpcy5kYXRhO1xuICAgIHRoaXMuZmlsdGVyZWREYXRhLmVtaXQodGhpcy5maWx0ZXJEYXRhKTtcbiAgfVxuXG4gIHVuQ2hlY2tlZENoZWNrQm94ZXMoZGF0YTogYW55KSB7XG4gICAgZGF0YS5mb3JFYWNoKChlbGVtZW50OiBhbnkpID0+IHtcbiAgICAgIGVsZW1lbnQuaXNDaGVja2VkID0gZmFsc2U7XG4gICAgfSlcbiAgfVxuXG4gIGNsZWFyUmFuZ2VTbGlkZXJGaWx0ZXIoZGF0YTogYW55KSB7XG4gICAgZGF0YS5yYW5nZVZhbHVlID0gZGF0YS5kZWZhdWx0UmFuZ2VWYWx1ZTtcbiAgICBkYXRhLmRyb3BEb3duUmFuZ2VWYWx1ZXMgPSBbXTtcbiAgICBkYXRhLmRyb3BEb3duUmFuZ2VWYWx1ZXMgPSBkYXRhLmRlZmF1bHRSYW5nZVZhbHVlO1xuICB9XG5cbiAgc2hvd01vcmVJdGVtcyhmaWx0ZXJCeTogc3RyaW5nLHNob3dTdGF0dXM6IGJvb2xlYW4pIHtcbiAgICBpZihzaG93U3RhdHVzKSB7XG4gICAgICB0aGlzLnRlbXBGaWx0ZXJbZmlsdGVyQnldWydmaWx0ZXJDaGVja0JveExpbWl0J10gPSB0aGlzLnRlbXBGaWx0ZXJbZmlsdGVyQnldLmxlbmd0aDtcbiAgICAgIHRoaXMudGVtcEZpbHRlcltmaWx0ZXJCeV1bJ2lzU2hvd01vcmUnXSA9IHRydWU7XG4gICAgfSBlbHNlIGlmKCFzaG93U3RhdHVzKSB7XG4gICAgICB0aGlzLnRlbXBGaWx0ZXJbZmlsdGVyQnldWydpc1Nob3dNb3JlJ10gPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuXG4gIHJhbmdlRHJvcERvd25PbkNoYW5nZShkYXRhOiBhbnkpIHtcbiAgICBkYXRhLnJhbmdlVmFsdWUgPSBkYXRhLmRyb3BEb3duUmFuZ2VWYWx1ZXM7XG4gICAgdGhpcy5hcHBseUZpbHRlcigpO1xuICB9XG5cbiAgc2xpZGVyQ2hhbmdlKGRhdGE6IGFueSB8IHVuZGVmaW5lZCkge1xuICAgIGRhdGEuZHJvcERvd25SYW5nZVZhbHVlcyA9IGRhdGEucmFuZ2VWYWx1ZVxuICB9XG59XG4iXX0=